<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trading DNA Assessment - DeFi University</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #0f0f0f 0%, #1a1a2e 100%);
            min-height: 100vh;
            color: #fff;
            padding: 20px;
        }
        .container { max-width: 700px; margin: 0 auto; }
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding: 25px;
            background: rgba(255,255,255,0.05);
            border-radius: 16px;
            border: 1px solid rgba(255,255,255,0.1);
            position: relative;
        }
        .header h1 {
            font-size: 24px;
            background: linear-gradient(135deg, #a3e635, #65a30d);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 8px;
        }
        .header p { color: #888; font-size: 14px; }
        #points-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background: linear-gradient(135deg, #a3e635, #65a30d);
            color: #000;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            opacity: 0;
            transform: translateY(-10px);
            transition: all 0.3s ease;
        }
        #points-badge.show { opacity: 1; transform: translateY(0); }
        .card {
            background: rgba(255,255,255,0.05);
            border-radius: 16px;
            padding: 20px;
            border: 1px solid rgba(255,255,255,0.1);
            margin-bottom: 15px;
        }
        .question-item {
            padding: 20px;
            margin-bottom: 15px;
            background: rgba(255,255,255,0.03);
            border-radius: 10px;
        }
        .question-text {
            font-weight: 500;
            margin-bottom: 15px;
            line-height: 1.6;
        }
        .rating-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        .rating-btn {
            flex: 1;
            min-width: 60px;
            padding: 12px;
            background: rgba(255,255,255,0.05);
            border: 2px solid rgba(255,255,255,0.1);
            border-radius: 8px;
            color: #fff;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
        }
        .rating-btn:hover { border-color: rgba(163, 230, 53, 0.5); background: rgba(163, 230, 53, 0.05); }
        .rating-btn.selected {
            border-color: #a3e635;
            background: rgba(163, 230, 53, 0.15);
            color: #a3e635;
        }
        .results {
            display: none;
            text-align: center;
            padding: 30px;
        }
        .score-display {
            font-size: 72px;
            font-weight: 700;
            margin: 20px 0;
            background: linear-gradient(135deg, #a3e635, #65a30d);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .mindset-type {
            font-size: 24px;
            font-weight: 600;
            margin: 20px 0;
            color: #a3e635;
        }
        .feedback {
            padding: 20px;
            background: rgba(163, 230, 53, 0.1);
            border-radius: 12px;
            border: 1px solid rgba(163, 230, 53, 0.3);
            margin-top: 20px;
            text-align: left;
        }
        .feedback-title { font-weight: 600; margin-bottom: 10px; color: #a3e635; }
        .feedback-text { font-size: 14px; color: #ccc; line-height: 1.6; }
        .btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, #a3e635, #65a30d);
            border: none;
            border-radius: 12px;
            color: #000;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            margin-top: 20px;
        }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 4px 20px rgba(163, 230, 53, 0.3); }
        .btn:disabled { opacity: 0.5; cursor: not-allowed; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div id="points-badge">+20 pts earned!</div>
            <h1>ðŸ§¬ Trading DNA Assessment</h1>
            <p>Discover your trading psychology profile</p>
        </div>
        <div id="assessment" class="card">
            <div class="question-item" data-question="1">
                <div class="question-text">I learn more from my losses than my wins</div>
                <div class="rating-buttons">
                    <button class="rating-btn" onclick="selectRating(1, 1)">1</button>
                    <button class="rating-btn" onclick="selectRating(1, 2)">2</button>
                    <button class="rating-btn" onclick="selectRating(1, 3)">3</button>
                    <button class="rating-btn" onclick="selectRating(1, 4)">4</button>
                    <button class="rating-btn" onclick="selectRating(1, 5)">5</button>
                    <button class="rating-btn" onclick="selectRating(1, 6)">6</button>
                    <button class="rating-btn" onclick="selectRating(1, 7)">7</button>
                    <button class="rating-btn" onclick="selectRating(1, 8)">8</button>
                    <button class="rating-btn" onclick="selectRating(1, 9)">9</button>
                    <button class="rating-btn" onclick="selectRating(1, 10)">10</button>
                </div>
            </div>
            <div class="question-item" data-question="2">
                <div class="question-text">I can admit when I'm wrong about a protocol</div>
                <div class="rating-buttons">
                    <button class="rating-btn" onclick="selectRating(2, 1)">1</button>
                    <button class="rating-btn" onclick="selectRating(2, 2)">2</button>
                    <button class="rating-btn" onclick="selectRating(2, 3)">3</button>
                    <button class="rating-btn" onclick="selectRating(2, 4)">4</button>
                    <button class="rating-btn" onclick="selectRating(2, 5)">5</button>
                    <button class="rating-btn" onclick="selectRating(2, 6)">6</button>
                    <button class="rating-btn" onclick="selectRating(2, 7)">7</button>
                    <button class="rating-btn" onclick="selectRating(2, 8)">8</button>
                    <button class="rating-btn" onclick="selectRating(2, 9)">9</button>
                    <button class="rating-btn" onclick="selectRating(2, 10)">10</button>
                </div>
            </div>
            <div class="question-item" data-question="3">
                <div class="question-text">I stick to my plan during extreme volatility</div>
                <div class="rating-buttons">
                    <button class="rating-btn" onclick="selectRating(3, 1)">1</button>
                    <button class="rating-btn" onclick="selectRating(3, 2)">2</button>
                    <button class="rating-btn" onclick="selectRating(3, 3)">3</button>
                    <button class="rating-btn" onclick="selectRating(3, 4)">4</button>
                    <button class="rating-btn" onclick="selectRating(3, 5)">5</button>
                    <button class="rating-btn" onclick="selectRating(3, 6)">6</button>
                    <button class="rating-btn" onclick="selectRating(3, 7)">7</button>
                    <button class="rating-btn" onclick="selectRating(3, 8)">8</button>
                    <button class="rating-btn" onclick="selectRating(3, 9)">9</button>
                    <button class="rating-btn" onclick="selectRating(3, 10)">10</button>
                </div>
            </div>
            <div class="question-item" data-question="4">
                <div class="question-text">I view market crashes as buying opportunities</div>
                <div class="rating-buttons">
                    <button class="rating-btn" onclick="selectRating(4, 1)">1</button>
                    <button class="rating-btn" onclick="selectRating(4, 2)">2</button>
                    <button class="rating-btn" onclick="selectRating(4, 3)">3</button>
                    <button class="rating-btn" onclick="selectRating(4, 4)">4</button>
                    <button class="rating-btn" onclick="selectRating(4, 5)">5</button>
                    <button class="rating-btn" onclick="selectRating(4, 6)">6</button>
                    <button class="rating-btn" onclick="selectRating(4, 7)">7</button>
                    <button class="rating-btn" onclick="selectRating(4, 8)">8</button>
                    <button class="rating-btn" onclick="selectRating(4, 9)">9</button>
                    <button class="rating-btn" onclick="selectRating(4, 10)">10</button>
                </div>
            </div>
            <div class="question-item" data-question="5">
                <div class="question-text">I take profits even when tokens keep climbing</div>
                <div class="rating-buttons">
                    <button class="rating-btn" onclick="selectRating(5, 1)">1</button>
                    <button class="rating-btn" onclick="selectRating(5, 2)">2</button>
                    <button class="rating-btn" onclick="selectRating(5, 3)">3</button>
                    <button class="rating-btn" onclick="selectRating(5, 4)">4</button>
                    <button class="rating-btn" onclick="selectRating(5, 5)">5</button>
                    <button class="rating-btn" onclick="selectRating(5, 6)">6</button>
                    <button class="rating-btn" onclick="selectRating(5, 7)">7</button>
                    <button class="rating-btn" onclick="selectRating(5, 8)">8</button>
                    <button class="rating-btn" onclick="selectRating(5, 9)">9</button>
                    <button class="rating-btn" onclick="selectRating(5, 10)">10</button>
                </div>
            </div>
            <div class="question-item" data-question="6">
                <div class="question-text">I cut losses before they become disasters</div>
                <div class="rating-buttons">
                    <button class="rating-btn" onclick="selectRating(6, 1)">1</button>
                    <button class="rating-btn" onclick="selectRating(6, 2)">2</button>
                    <button class="rating-btn" onclick="selectRating(6, 3)">3</button>
                    <button class="rating-btn" onclick="selectRating(6, 4)">4</button>
                    <button class="rating-btn" onclick="selectRating(6, 5)">5</button>
                    <button class="rating-btn" onclick="selectRating(6, 6)">6</button>
                    <button class="rating-btn" onclick="selectRating(6, 7)">7</button>
                    <button class="rating-btn" onclick="selectRating(6, 8)">8</button>
                    <button class="rating-btn" onclick="selectRating(6, 9)">9</button>
                    <button class="rating-btn" onclick="selectRating(6, 10)">10</button>
                </div>
            </div>
            <div class="question-item" data-question="7">
                <div class="question-text">I research protocols before following hype</div>
                <div class="rating-buttons">
                    <button class="rating-btn" onclick="selectRating(7, 1)">1</button>
                    <button class="rating-btn" onclick="selectRating(7, 2)">2</button>
                    <button class="rating-btn" onclick="selectRating(7, 3)">3</button>
                    <button class="rating-btn" onclick="selectRating(7, 4)">4</button>
                    <button class="rating-btn" onclick="selectRating(7, 5)">5</button>
                    <button class="rating-btn" onclick="selectRating(7, 6)">6</button>
                    <button class="rating-btn" onclick="selectRating(7, 7)">7</button>
                    <button class="rating-btn" onclick="selectRating(7, 8)">8</button>
                    <button class="rating-btn" onclick="selectRating(7, 9)">9</button>
                    <button class="rating-btn" onclick="selectRating(7, 10)">10</button>
                </div>
            </div>
            <div class="question-item" data-question="8">
                <div class="question-text">I maintain perspective during FOMO moments</div>
                <div class="rating-buttons">
                    <button class="rating-btn" onclick="selectRating(8, 1)">1</button>
                    <button class="rating-btn" onclick="selectRating(8, 2)">2</button>
                    <button class="rating-btn" onclick="selectRating(8, 3)">3</button>
                    <button class="rating-btn" onclick="selectRating(8, 4)">4</button>
                    <button class="rating-btn" onclick="selectRating(8, 5)">5</button>
                    <button class="rating-btn" onclick="selectRating(8, 6)">6</button>
                    <button class="rating-btn" onclick="selectRating(8, 7)">7</button>
                    <button class="rating-btn" onclick="selectRating(8, 8)">8</button>
                    <button class="rating-btn" onclick="selectRating(8, 9)">9</button>
                    <button class="rating-btn" onclick="selectRating(8, 10)">10</button>
                </div>
            </div>
            <button class="btn" id="submit-btn" onclick="showResults()" disabled>View Results</button>
        </div>
        <div id="results" class="results">
            <div class="score-display" id="score-display">-</div>
            <div class="mindset-type" id="mindset-type">-</div>
            <div class="feedback">
                <div class="feedback-title">Your Assessment</div>
                <div class="feedback-text" id="feedback-text">-</div>
            </div>
            <button class="btn" onclick="location.reload()">Retake Assessment</button>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';

        const firebaseConfig = {
            apiKey: "AIzaSyDuGdDF6jYPcZbQTpbGZPwnl3Qynr-LMWc",
            authDomain: "defi-university-prod.firebaseapp.com",
            projectId: "defi-university-prod",
            storageBucket: "defi-university-prod.firebasestorage.app",
            messagingSenderId: "309871336262",
            appId: "1:309871336262:web:d2dc4be5729ac1d5a6a347"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        let userToken = null;
        let tracked = false;
        const answers = {};

        onAuthStateChanged(auth, async (user) => {
            if (user) userToken = await user.getIdToken();
        });

        window.selectRating = function(question, rating) {
            answers[question] = rating;
            const questionEl = document.querySelector(`[data-question="${question}"]`);
            questionEl.querySelectorAll('.rating-btn').forEach(btn => btn.classList.remove('selected'));
            event.target.classList.add('selected');

            const allAnswered = Object.keys(answers).length === 8;
            document.getElementById('submit-btn').disabled = !allAnswered;
        };

        window.showResults = async function() {
            const total = Object.values(answers).reduce((sum, val) => sum + val, 0);
            const score = total;
            const percentage = (total / 80) * 100;

            document.getElementById('assessment').style.display = 'none';
            document.getElementById('results').style.display = 'block';
            document.getElementById('score-display').textContent = `${score}/80`;

            let mindsetType, feedback;
            if (score >= 56) {
                mindsetType = 'Growth Mindset Dominant';
                feedback = 'You have the psychological foundation for DeFi success! Your growth mindset helps you learn from losses, adapt to market changes, and maintain discipline. Continue building on these strengths while remaining vigilant against complacency. Focus on maintaining your systematic approach and emotional regulation.';
            } else if (score >= 40) {
                mindsetType = 'Mixed Mindset';
                feedback = 'You show promise but need focused work on specific psychological gaps. Your mixed mindset indicates some growth-oriented thinking but also areas where fixed mindset patterns may be limiting your success. Review Lessons 1-4 on mindset, discipline, and emotional management. Practice the exercises and build daily habits to shift toward growth mindset.';
            } else {
                mindsetType = 'Fixed Mindset Currently Limiting Success';
                feedback = 'This isn\'t a life sentenceâ€”it\'s a starting point for transformation. Your fixed mindset patterns are currently limiting your trading success, but awareness is the first step. Commit to the full Investor Mindset course, complete all exercises, and practice the daily habits. Focus on viewing losses as education, admitting mistakes quickly, and building systematic discipline.';
            }

            document.getElementById('mindset-type').textContent = mindsetType;
            document.getElementById('feedback-text').textContent = feedback;

            if (!tracked && userToken) {
                tracked = true;
                try {
                    const response = await fetch('https://api.defiuniversity.xyz/api/progress/interaction', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json', 'Authorization': `Bearer ${userToken}` },
                        body: JSON.stringify({ courseId: 'investor-mindset', interactionId: 'trading-dna-assessment', type: 'assessment' })
                    });
                    if (response.ok) {
                        const badge = document.getElementById('points-badge');
                        badge.classList.add('show');
                        setTimeout(() => badge.classList.remove('show'), 2500);
                    }
                } catch (e) { console.error('Tracking error:', e); }
            }
        };
    </script>
</body>
</html>
